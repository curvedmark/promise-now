!function(){function t(){this.state=r,this.composers=[]}function n(t){return t&&"function"==typeof t.then}function s(t,s){return function(i,r,u){var h;if(i===e&&"function"==typeof(h=t)||i===o&&"function"==typeof(h=s)){try{r=h(r)}catch(p){return r=p,i=o,u(i,r)}if(n(r))return r.then(function(t){u(e,t)},function(t){u(o,t)});i=e}u(i,r)}}function i(){this.queue=[],this.started=!1}var r=0,e=1,o=2;t.prototype.then=function(t,n){var r=new i;return r.add(s(t,n)),this.state?this.runComposer(r):this.composers.push(r),{then:function(t,n){return r.add(s(t,n)),this}}},t.prototype.fulfill=function(t){return this.state?this:(this.state=e,this.arg=t,this.runAllComposers(),this)},t.prototype.reject=function(t){return this.state?this:(this.state=o,this.arg=t,this.runAllComposers(),this)},t.prototype.runComposer=function(t){t.run(this.state,this.arg)},t.prototype.runAllComposers=function(){for(var t=0,n=this.composers.length;n>t;++t)this.composers[t].run(this.state,this.arg);this.composers=null};var u=[].push;i.prototype.add=function(t){this.queue.push(t),this.started&&this.runOne()},i.prototype.run=function(){this.started=!0,this.args=arguments,this.runOne()},i.prototype.runOne=function(){if(!this.pending&&this.queue.length){var t=this.queue.shift(),n=this;u.call(this.args,function(){n.pending=!1,n.args=arguments,n.runOne()}),this.pending=!0,t.apply(void 0,this.args)}},window.Promise=t}();