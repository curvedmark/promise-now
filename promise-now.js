!function(){function t(){this.state=i,this.callbacks=[]}var i=0,n=1,e=2;t.prototype.then=function(i,n){var e=new t,r=this.createCallback(i,n,e);return this.state?this.runCallback(r):this.callbacks.push(r),e},t.prototype.fulfill=function(t,i){return this.state?this:(this.state=n,this.arg=t,this.context=i,this.runCallbacks(),this)},t.prototype.reject=function(t,i){if(this.state)return this;if(this.ended)throw t;return this.state=e,this.arg=t,this.context=i,this.runCallbacks(),this},t.prototype.runCallback=function(t){t()},t.prototype.runCallbacks=function(){for(var t=0,i=this.callbacks.length;i>t;++t)this.callbacks[t]();this.callbacks=null},t.prototype.createCallback=function(t,i,e){var r=this;return function(){var s,a=r.state,c=r.arg,l=r.context;if(a===n){if("function"!=typeof t)return e.fulfill(c,l);s=t}else{if("function"!=typeof i)return e.reject(c,l);s=i}try{c=s.call(l,c)}catch(o){return e.reject(o,l)}return c&&"function"==typeof c.then?(c.then(function(t){e.fulfill(t,l)},function(t){e.reject(t,l)}),void 0):e.fulfill(c,l)}},t.prototype.end=function(){if(!this.state)return this.ended=!0,this;if(this.state===e)throw this.arg},window.Promise=t}();