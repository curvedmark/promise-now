!function(){function t(){this.state="pending",this.composers=[]}function n(t){return t&&"function"==typeof t.then}function s(t,s){return function(e,i,r){var o;if("fulfilled"===e&&"function"==typeof(o=t)||"rejected"===e&&"function"==typeof(o=s)){try{i=o(i)}catch(h){return i=h,e="rejected",r(e,i)}if(n(i))return i.then(function(t){r("fulfilled",t)},function(t){r("rejected",t)});e="fulfilled"}r(e,i)}}function e(){this.fns=[],this.started=!1}t.prototype.then=function(t,n){var i=new e;return i.add(s(t,n)),this.composers.push(i),"pending"!==this.state&&this.runAllComposers(),{then:function(t,n){return i.add(s(t,n)),this}}},t.prototype.fulfill=function(t){return"pending"!==this.state?this:(this.state="fulfilled",this.value=t,this.runAllComposers(),this)},t.prototype.reject=function(t){return"pending"!==this.state?this:(this.state="rejected",this.reason=t,this.runAllComposers(),this)},t.prototype.runAllComposers=function(){for(var t="fulfilled"===this.state?this.value:this.reason;this.composers.length;){var n=this.composers.shift();n.run(this.state,t)}};var i=[].slice;e.prototype.add=function(t){this.fns.push(t),this.started&&this.runOne()},e.prototype.run=function(){this.started=!0,this.args=i.call(arguments,0),this.runOne()},e.prototype.runOne=function(){if(!this.pending&&this.fns.length){var t=this.fns.shift(),n=this;this.args.push(function(){n.pending=!1,n.args=i.call(arguments,0),n.runOne()}),this.pending=!0,t.apply(void 0,this.args)}},window.Promise=t}();